'use client'

import { useState, useEffect } from 'react'
import { Card, Table } from 'react-bootstrap'
import { Spinner } from '@/components'

interface IWebScanTable {
  data: any
  onChangeWebUrl: (scanId: string, scanUrl: string) => void
}

export default function WebScanTable({ onChangeWebUrl, data }: IWebScanTable) {
  const handleChooseWebUrl = (scanId: string, scanUrl: string) => {
    onChangeWebUrl(scanId, scanUrl)
  }
  const [isLoading, setIsLoading] = useState<boolean>(true)

  useEffect(() => {
    if (data && data.length > 0) {
      setIsLoading(false)
    }
  }, [data])

  return (
    <Card>
      <Card.Body>
        <h4 className="header-title mb-3">Web Scans Result</h4>
        <div className="table-custom-layout" style={{ height: '400px' }}>
          {isLoading && <Spinner />}
          {!isLoading && (
            <Table className="table-centered mb-0" style={{ height: '400px' }}>
              <thead className="table-light">
                <tr>
                  <th>WEB SITE URL</th>
                  <th>LAST REPORT</th>
                  <th>LAST AUDIT TRIGGERED</th>
                </tr>
              </thead>
              <tbody>
                {data.map((item: any) => {
                  return (
                    <tr key={item.scanId}>
                      <td>
                        <a
                          href="#"
                          onClick={() =>
                            handleChooseWebUrl(item.scanId, item.scanUrl)
                          }>
                          {item.scanUrl}
                        </a>
                      </td>
                      <td>{item.scanDate.toString()}</td>
                      <td></td>
                    </tr>
                  )
                })}
              </tbody>
            </Table>
          )}
        </div>
      </Card.Body>
    </Card>
  )
}
